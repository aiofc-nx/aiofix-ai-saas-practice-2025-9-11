# Aiofix AI SaaS Platform - 环境变量配置示例
# 复制此文件为 .env 并修改相应的值

# ===================
# 应用配置
# ===================
NODE_ENV=development
PORT=3000
API_PREFIX=api/v1

# ===================
# 数据库配置
# ===================

# PostgreSQL 主数据库
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=aiofix_platform
POSTGRES_USER=aiofix_user
POSTGRES_PASSWORD=aiofix_password

# PostgreSQL 连接池配置
POSTGRES_POOL_MIN=2
POSTGRES_POOL_MAX=10
POSTGRES_POOL_IDLE_TIMEOUT=30000

# MongoDB 事件存储
MONGODB_URI=mongodb://aiofix_admin:aiofix_password@localhost:27017/aiofix_events?authSource=admin
MONGODB_EVENTS_DB=aiofix_events

# AI 向量数据库配置（独立数据库，需要pgvector扩展）
AI_VECTORS_DB=aiofix_ai_vectors
AI_VECTORS_HOST=localhost
AI_VECTORS_PORT=5432
AI_VECTORS_USER=aiofix_user
AI_VECTORS_PASSWORD=aiofix_password

# 数据隔离策略配置
DATA_ISOLATION_STRATEGY=table_level
DEFAULT_TENANT_ID=00000000-0000-0000-0000-000000000001

# 数据库级隔离配置
TENANT_DB_PREFIX=aiofix_tenant_
PLATFORM_DB_NAME=aiofix_platform
EVENTS_DB_NAME=aiofix_events

# Schema级隔离配置
TENANT_SCHEMA_PREFIX=tenant_
SHARED_SCHEMA_NAME=shared

# 表级隔离配置
ENABLE_RLS=true
TENANT_ID_FIELD=tenant_id
AUTO_ADD_TENANT_CONDITION=true

# ===================
# Redis 配置
# ===================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Redis 连接池配置
REDIS_POOL_MIN=2
REDIS_POOL_MAX=10
REDIS_POOL_IDLE_TIMEOUT=30000

# ===================
# 消息队列配置
# ===================
BULL_REDIS_HOST=localhost
BULL_REDIS_PORT=6379
BULL_REDIS_PASSWORD=
BULL_REDIS_DB=1

# 队列配置
QUEUE_CONCURRENCY=5
QUEUE_ATTEMPTS=3
QUEUE_BACKOFF_DELAY=2000

# ===================
# 认证配置
# ===================
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=24h
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-this-in-production
JWT_REFRESH_EXPIRES_IN=7d

# ===================
# 加密配置
# ===================
ENCRYPTION_KEY=your-32-character-encryption-key-here
BCRYPT_ROUNDS=12

# ===================
# 文件存储配置
# ===================
UPLOAD_MAX_SIZE=10485760
UPLOAD_ALLOWED_TYPES=image/jpeg,image/png,image/gif,application/pdf

# ===================
# 邮件配置
# ===================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
SMTP_FROM=noreply@aiofix.com

# ===================
# 推送通知配置
# ===================
FCM_SERVER_KEY=your-fcm-server-key
APNS_KEY_ID=your-apns-key-id
APNS_TEAM_ID=your-apns-team-id
APNS_BUNDLE_ID=com.aiofix.app

# ===================
# 短信配置
# ===================
SMS_PROVIDER=twilio
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# ===================
# 监控配置
# ===================
PROMETHEUS_PORT=9090
GRAFANA_PORT=3001
LOG_LEVEL=info
LOG_FORMAT=json

# ===================
# 缓存配置
# ===================
CACHE_TTL=3600
CACHE_MAX_ITEMS=1000
CACHE_CHECK_PERIOD=600

# ===================
# 限流配置
# ===================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# ===================
# 跨域配置
# ===================
CORS_ORIGIN=http://localhost:3000,http://localhost:3001
CORS_CREDENTIALS=true

# ===================
# 安全配置
# ===================
HELMET_ENABLED=true
CSP_ENABLED=true
HSTS_ENABLED=true

# ===================
# 开发工具配置
# ===================
SWAGGER_ENABLED=true
SWAGGER_PATH=api/docs
GRAPHQL_ENABLED=false
GRAPHQL_PATH=graphql

# ===================
# 多租户配置
# ===================
MULTI_TENANT_ENABLED=true
TENANT_HEADER=x-tenant-id
DEFAULT_TENANT_ID=platform

# ===================
# 事件驱动配置
# ===================
EVENT_STORE_TYPE=mongodb
EVENT_BUS_TYPE=redis
MESSAGE_QUEUE_TYPE=bull
EVENT_SNAPSHOT_INTERVAL=100

# ===================
# 性能配置
# ===================
CLUSTER_MODE=false
CLUSTER_WORKERS=0
COMPRESSION_ENABLED=true
COMPRESSION_THRESHOLD=1024
